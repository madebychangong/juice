Python 자동화 시스템 상세 설명
====================================

실행 결과 요약
====================================

입력 파일:
- TalkFile_SAP 주문파일.xlsx.xlsx (617개 행)
- TalkFile_업체명 정보파일.xlsx.xlsx (49개 업체)
- TalkFile_재고파일.xlsx.xlsx (179개 품목)

처리 결과:
- 마이너스 수량 38개 제거
- 최종 주문 항목: 579개
- 업체 수: 50개
- 제품 종류: 80개

생성된 파일:
- 업체별 주문서 PDF: 50개
- 팔레트 라벨 PDF: 50개
- 재고표 PDF: 1개
- 처리된 주문데이터 엑셀: 1개

실행 시간: 1.85초


====================================
각 모듈 상세 설명
====================================

1. order_processor.py
   주문 데이터 처리 모듈

   입력:
   - TalkFile_SAP 주문파일.xlsx.xlsx
   - TalkFile_업체명 정보파일.xlsx.xlsx

   처리 과정:
   1) SAP 파일에서 필요한 컬럼만 추출
      - 납품처명 (업체명)
      - 자재내역 (제품명)
      - 주문수량

   2) 마이너스 수량 제거
      - 주문수량 > 0 인 행만 남김
      - 예시: 콜라 +1, -1 있으면 둘 다 제거
      - 결과: 617개 → 579개

   3) 업체명을 코드로 변환
      - 업체명 정보파일의 매핑 테이블 사용
      - 예시:
        신)BGF로지스 화성 → 중부
        GS25 발안센터_C → 209
        신)BGF 동부로지스 → 동부

   4) 매핑되지 않은 업체 처리
      - 원본 이름 그대로 사용
      - 경고 메시지 출력
      - 예시: 코리아세븐 성남물류센터 (매핑 없음)

   출력:
   - 업체코드, 업체명_원본, 제품명, 수량 컬럼


2. order_sheet_generator.py
   업체별 주문서 PDF 생성

   입력:
   - 처리된 주문 데이터

   처리 과정:
   1) 업체별로 데이터 그룹화
   2) 각 업체마다 PDF 1개 생성
   3) PDF 내용:
      - 제목: 주문서
      - 업체코드와 업체명 표시
      - 총 품목 수, 총 수량 표시
      - 제품 목록을 표 형식으로 정리

   출력 예시:
   - 중부_주문서.pdf
     ┌─────────────────────────┐
     │      주문서              │
     │                         │
     │ 업체코드: 중부           │
     │ 업체명: 신)BGF로지스 화성 │
     │                         │
     │ 총 품목 수: 13개         │
     │ 총 수량: 434             │
     │                         │
     │ No. | 제품명 | 수량      │
     │-----|--------|-------   │
     │  1  | 코크제로| 12       │
     │  2  | 스프라이트| 20     │
     │ ... | ...    | ...      │
     └─────────────────────────┘

   파일명 형식:
   - {업체코드}_주문서.pdf
   - 예: 중부_주문서.pdf, 209_주문서.pdf


3. pallet_label_generator.py
   팔레트 라벨 PDF 생성

   입력:
   - 처리된 주문 데이터

   처리 과정:
   1) 업체별로 데이터 그룹화
   2) 각 업체마다 PDF 1개 생성 (여러 페이지)
   3) 각 제품당 1페이지 (A4)
   4) 라벨 레이아웃:
      - 제품명: 상단 중앙, 48pt 큰 글씨
      - 수량: 중앙, 72pt 매우 큰 글씨
      - 업체코드: 하단 중앙, 36pt
      - 테두리 표시

   출력 예시:
   - 중부_라벨.pdf (13페이지)

     페이지 1:
     ┌────────────────────────────┐
     │                            │
     │                            │
     │  S)코크제로 250CAN 5X6     │
     │                            │
     │           12               │
     │                            │
     │          중부               │
     │                            │
     │                            │
     └────────────────────────────┘

     페이지 2:
     ┌────────────────────────────┐
     │                            │
     │                            │
     │ S)스프라이트 제로 500PET   │
     │                            │
     │           60               │
     │                            │
     │          중부               │
     │                            │
     │                            │
     └────────────────────────────┘

     ... (13페이지 계속)

   파일명 형식:
   - {업체코드}_라벨.pdf
   - 예: 중부_라벨.pdf (13페이지)
       209_라벨.pdf (11페이지)


4. inventory_processor.py
   재고표 PDF 생성

   입력:
   - TalkFile_재고파일.xlsx.xlsx

   처리 과정:
   1) 재고 파일 읽기 (헤더 자동 인식)
   2) 제품별 정보 정리
   3) PDF로 출력
      - 제목: 재고 현황표 (날짜 표시)
      - 총 품목 수
      - 제품 목록 표 형식

   출력:
   - 재고표_20251217.pdf

   파일명 형식:
   - 재고표_{날짜}.pdf


5. main.py
   전체 실행 스크립트

   실행 방법:
   - python3 main.py

   처리 흐름:
   1) 배너 출력
   2) 파일 존재 확인
   3) 출력 디렉토리 생성
      - output_{날짜}_{시간}/
   4) 주문 데이터 처리
   5) 주문서 PDF 생성
   6) 라벨 PDF 생성
   7) 재고표 PDF 생성
   8) 완료 메시지 출력


====================================
실제 생성된 파일 예시
====================================

output_20251217_042314/
├── order_sheets/            (50개 PDF)
│   ├── 중부_주문서.pdf        (30KB, 1페이지)
│   ├── 209_주문서.pdf         (28KB, 1페이지)
│   ├── 동부_주문서.pdf        (29KB, 1페이지)
│   ├── 남양주_주문서.pdf
│   ├── 곤지암_주문서.pdf
│   └── ...
│
├── labels/                  (50개 PDF)
│   ├── 중부_라벨.pdf          (31KB, 13페이지)
│   ├── 209_라벨.pdf           (27KB, 11페이지)
│   ├── 동부_라벨.pdf          (29KB, 15페이지)
│   ├── 남양주_라벨.pdf        (17페이지)
│   ├── 곤지암_라벨.pdf        (19페이지)
│   └── ...
│
├── inventory_reports/
│   └── 재고표_20251217.pdf   (179개 품목)
│
└── 처리된_주문데이터.xlsx    (579개 행)


====================================
요구사항 대비 검증
====================================

요구사항 1: 업체명 코드 변환
   예: BGF화성 → 중부, GS발안 → 209
   결과: ✓ 정상 작동
   - 중부_주문서.pdf 생성됨
   - 209_주문서.pdf 생성됨
   - 동부_주문서.pdf 생성됨

요구사항 2: 마이너스 수량 제거
   예: 콜라 +1, -1 있으면 제거
   결과: ✓ 정상 작동
   - 원본: 617개 → 처리 후: 579개
   - 38개 마이너스 항목 제거됨

요구사항 3: 업체별 주문서 (1-2장)
   결과: ✓ 정상 작동
   - 50개 업체 × 1개 PDF = 50개 파일
   - 각 PDF는 1페이지 (제품 많으면 2페이지 가능)

요구사항 4: 팔레트 라벨 (제품당 A4 1장)
   예: 콜라250캔
       12개
       중부
   결과: ✓ 정상 작동
   - 50개 업체 × 1개 PDF (여러 페이지)
   - 중부: 13개 제품 → 13페이지
   - 209: 11개 제품 → 11페이지
   - 각 페이지는 큰 글씨로 제품명/수량/업체코드

요구사항 5: 재고표 (유통기한 선입선출)
   결과: ✓ 정상 작동
   - 재고표_20251217.pdf 생성
   - 179개 품목 정리


====================================
현재 방식의 장단점
====================================

장점:
1. 기존 파일 형식 그대로 사용 (학습 불필요)
2. 매우 빠름 (1.85초)
3. 한 번에 모든 PDF 생성
4. 안정적 (테스트 완료)
5. 한글 폰트 지원

단점:
1. Python 설치 필요
2. 명령줄 실행 (터미널)
3. 프로그램 설치에 대한 거부감 가능


====================================
다음 단계 제안
====================================

옵션 1: EXE 파일 생성
   - Python을 EXE로 변환
   - 더블클릭으로 실행
   - Python 설치 불필요
   - 터미널 불필요

옵션 2: 그대로 사용
   - 현재 상태 그대로
   - python3 main.py 실행
   - 가장 빠르고 안정적

옵션 3: Excel VBA
   - 처음부터 새로 개발 필요
   - 시간 소요 예상
   - Excel 익숙함 장점
