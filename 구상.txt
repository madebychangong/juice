
[프로젝트: 음료회사 주문/라벨/재고 자동화 구상]

전체 목표
SAP에서 받은 주문 데이터를 바탕으로,
  1) 업체별 주문서 출력
  2) 제품별 팔레트 라벨(A4) 출력
  3) 재고표(선입선출용) 자동 정리/출력
데이터 관리는 주로 스프레드시트(예: Google Sheets)에서 하고,
  인쇄용 파일(PDF)은 자동으로 생성하는 방향으로 설계.

--------------------------------------------------
[1. 데이터 흐름 개요]

1) SAP → 엑셀 추출
SAP에서 당일(또는 기간별) 주문 데이터를 엑셀로 다운로드.

2) 엑셀 → 스프레드시트로 복사/업로드
엑셀 데이터를 스프레드시트의 "원본_주문데이터" 시트에 붙여넣기.

3) 스프레드시트에서 자동 가공
업체명 → 업체코드 매핑
수량에서 마이너스(반품) 제거 또는 상쇄
업체별/제품별 집계
재고 데이터와 연동 (선입선출용)

4) 스프레드시트에서 PDF 생성
업체별 주문서 PDF 자동 생성
업체별/제품별 팔레트 라벨 PDF 자동 생성
재고표 PDF 자동 생성 또는 시트 인쇄

5) 인쇄
생성된 PDF들을 열어서 일반 인쇄 기능으로 출력
  (자동 인쇄까지는 강제하지 않고, PDF까지 자동으로 만들어주는 것을 목표로 함)

--------------------------------------------------
[2. 데이터 구조 설계]

(1) 시트: 원본_주문데이터
목적: SAP에서 가져온 원본 데이터를 그대로 붙여넣는 영역
예시 컬럼:
주문일자
주문번호
업체명(원본, 예: BGF화성, GS발안, 로지스 등)
제품명 (예: 콜라250캔, 사이다500캔 등)
수량 (양수: 주문, 음수: 반품)
기타 필요한 컬럼(있으면 추가)

(2) 시트: 업체코드_매핑
목적: 업체명을 코드로 변환하기 위한 매핑 테이블
예시 컬럼:
업체명_원본  |  업체코드
BGF화성     |  중부
GS발안      |  209
로지스      |  (코드)
… (약 50개 업체 모두)

(3) 시트: 주문_가공데이터
목적: 원본_주문데이터를 기준으로 가공된 데이터 저장
처리 내용:
업체명_원본 + VLOOKUP → 업체코드
수량에서 반품(음수) 처리:
같은 주문/제품 기준으로 +수량과 -수량을 합산해서 0이 되면 제외
또는 수량 > 0인 행만 사용하는지.
결과 컬럼 예:
주문일자
업체코드
제품명
최종수량(양수만, 또는 합산 결과)
이 시트를 기준으로 아래 기능들(업체별 주문서, 라벨, 재고)이 동작.

(4) 시트: 재고_원본
목적: 현재 보유 재고 및 유통기한 관리
예시 컬럼:
제품명
수량
유통기한
창고/위치

(5) 시트: 재고_표시(선입선출용)
목적: 재고_원본을 가공해서 유통기한 오름차순으로 정렬된 재고표
기능:
제품별/유통기한별 재고 정렬
선입선출 기준으로 현황 파악용
출력 시트 또는 PDF 생성 대상

--------------------------------------------------
[3. 기능 1: 업체별 주문서 출력]

목표:
각 업체(코드 기준)별로 "오늘 이 업체에 나갈 제품/수량"을 한눈에 볼 수 있는 주문서(PDF 또는 인쇄용 시트)를 생성.

처리 흐름:
1) 주문_가공데이터 시트에서 업체코드 기준으로 그룹화
예: 중부, 209, 로지스 등.

2) 각 업체별로 별도 레이아웃 생성
한 업체당 1~2장 정도로 A4에 정리.
컬럼 예:
제품명
수량
기타 필요 정보(예: 비고)

3) 출력 방식:
방법 A: 업체별로 시트/범위를 준비하고, 그 범위를 PDF로 내보내기.
방법 B: 여러 업체가 한 시트에 있어도 페이지 구분/필터 기능을 이용해서 업체 선택 후 인쇄.

주의사항:
반품(마이너스 수량)은 이미 가공 단계에서 제외 또는 합산 정리.
업체명은 반드시 코드(중부, 209 등) 기준으로 표현.

--------------------------------------------------
[4. 기능 2: 제품별 팔레트 라벨(A4) 출력]

업무 요구사항:
"업체당, 제품당, 팔레트당 A4 1장"이 필요.
각 장에는 글자가 **크게** 인쇄되어야 함.
예시 라벨:
콜라250캔
12개
중부
작업자가 지게차로 팔레트를 보고 한눈에 어느 업체/어느 제품/몇 개인지 알 수 있어야 함.

데이터 기준:
주문_가공데이터 시트에서,
업체코드
제품명
수량(팔레트 기준으로 나누거나, 그대로 표기할지 정책 필요)

라벨 레이아웃(한 페이지 예시):
상단 중앙: 제품명 (큰 글씨, 예: 48pt)
중간 중앙: 수량 ( 예: "12개", 36pt 정도)
하단 중앙: 업체코드 (예: "중부", 24pt 정도)

구상 방안 A: 한 업체 전체를 하나의 PDF로
업체별로 라벨을 모아서, 1개 PDF 파일에 여러 페이지로 생성.
예: 중부_라벨.pdf → 30페이지
전체 업체 수가 50개라면, PDF 파일 약 50개 생성.
장점:
파일 단위가 작아서 안정적.
인쇄도 업체별로 구분해서 하기 쉬움.
인쇄:
중부_라벨.pdf 열기 → 전체 페이지 인쇄.
209_라벨.pdf 열기 → 전체 페이지 인쇄.
…

구상 방안 B: 전체 라벨을 한 PDF에 몰기
1000장 PDF 1개로 만들 수도 있으나,
파일이 너무 커지고
업체별 구분이 어려움.
현재 생각으로는 **업체별 PDF 분리 방식(A)이 더 현실적**.

실제 처리 흐름(라벨):
1) 주문_가공데이터에서 업체코드 + 제품명 + 수량 기준으로 데이터 추출.
2) 업체코드별로 묶는다.
3) 각 업체에 대해:
라벨 템플릿 레이아웃을 이용해서 페이지를 하나씩 채운다.
한 제품당 1페이지.
4) 각 업체마다 "업체코드_라벨.pdf" 파일 생성.
5) 작업자는 업체별 PDF를 열어서 인쇄.

--------------------------------------------------
[5. 기능 3: 재고표(선입선출) 생성/출력]

목표:
유통기한 선입선출을 위한 재고표를 매일 자동으로 뽑을 수 있게 하는 것.
유통기한이 빠른 순으로 정렬된 리스트.

데이터 기준:
재고_원본 시트:
제품명
수량
유통기한
창고/위치

처리 내용:
1) 제품명 + 유통기한 기준으로 정렬 (유통기한 오름차순).
2) 필요하다면 제품별로 그룹화해서 표시:
예: 콜라250캔
2025-12-20: 30개
2025-12-25: 50개
3) 출력:
스프레드시트 상에서 보기 좋게 포맷팅된 시트를 만들고,
해당 시트를 바로 인쇄하거나 PDF로 저장.

--------------------------------------------------
[6. 인쇄 전략 요약]

1) 자동 인쇄(프린터까지 자동 명령)는 필수는 아님.
2) 중요한 것은:
"스프레드시트 데이터 → 업체별/제품별로 잘 포맷된 PDF"를 **자동 생성**하는 것.
3) 실제 프린트는:
생성된 PDF를 열어서 일반 인쇄(Ctrl+P)로 처리.
특히 업체별 PDF 분리는 현장에서 일 처리/분류에 유리.

--------------------------------------------------
[7. 앞으로 확인/결정해야 할 것들]

1) SAP 엑셀 원본의 실제 컬럼 구조
주문번호, 업체명, 제품명, 수량 외에 필요한 항목 여부.

2) 반품 처리 규칙
+1과 -1이 같이 있는 경우 0으로 상쇄해서 제외하는지,
아니면 단순히 수량 > 0인 행만 사용하는지.

3) 라벨에서 수량의 기준
팔레트 1개당 수량이 정해져 있는지?
예: 콜라250캔 1팔레트 = 12개?
아니면 총 수량만 크게 적는지?

4) 재고표에 필요한 추가 정보
예: 창고 위치, 로트번호, 비고 등.

5) PDF 저장 위치
구글 드라이브 내 폴더 구조:
/라벨/날짜/중부_라벨.pdf
/라벨/날짜/209_라벨.pdf
/재고/날짜/재고표_YYYYMMDD.pdf
또는 로컬로 다운로드해서 관리할지.

--------------------------------------------------
끝.

