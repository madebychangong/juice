음료회사 주문/라벨/재고 자동화 시스템
Google Sheets 버전 기획서

========================================
1. 목적
========================================

SAP에서 받은 주문 데이터를 Google Sheets에서 자동으로 처리하여
업체별 주문서, 팔레트 라벨, 재고표를 PDF로 생성합니다.

기존 수동 작업(2-3시간)을 자동화하여 시간을 절약합니다.


========================================
2. Google Sheets 구조
========================================

2-1. 시트 목록

[원본_주문데이터]
- SAP에서 받은 엑셀 데이터를 그대로 붙여넣는 시트
- 컬럼: 주문일자, 주문번호, 업체명(원본), 제품명, 수량

[업체코드_매핑]
- 업체명을 코드로 변환하는 테이블
- 컬럼: 업체명_원본, 업체코드
- 예시: BGF화성 -> 중부, GS발안 -> 209

[주문_가공데이터]
- 자동으로 처리된 데이터가 저장되는 시트
- 마이너스 수량 제거됨
- 업체명이 코드로 변환됨
- 컬럼: 업체코드, 제품명, 수량

[재고_원본]
- 재고 파일 데이터를 붙여넣는 시트
- 컬럼: 제품명, 수량, 유통기한, 위치

[재고_표시]
- 유통기한 순으로 정렬된 재고표
- 선입선출 기준으로 자동 정렬


2-2. 메뉴 버튼

상단 메뉴바에 "자동화" 메뉴 추가
- 데이터 처리하기
- 주문서 PDF 생성
- 라벨 PDF 생성
- 재고표 PDF 생성


========================================
3. 주요 기능
========================================

3-1. 데이터 처리하기

실행 방법:
메뉴 > 자동화 > 데이터 처리하기

처리 내용:
1) 원본_주문데이터 시트에서 데이터 읽기
2) 수량이 0 이하인 행 제거 (반품 제거)
3) 업체코드_매핑 시트를 참고하여 업체명을 코드로 변환
4) 결과를 주문_가공데이터 시트에 저장

결과:
- 주문_가공데이터 시트가 자동으로 채워짐
- 처리 완료 메시지 표시


3-2. 업체별 주문서 PDF 생성

실행 방법:
메뉴 > 자동화 > 주문서 PDF 생성

처리 내용:
1) 주문_가공데이터를 업체별로 그룹화
2) 각 업체마다 1개의 PDF 파일 생성
3) PDF 내용: 업체코드, 제품 목록, 수량을 표로 정리

PDF 저장 위치:
Google Drive > 자동화_출력 > 주문서 폴더

파일명 형식:
업체코드_주문서_날짜.pdf
예시: 중부_주문서_20251217.pdf

예상 소요 시간: 약 3분 (50개 업체 기준)


3-3. 팔레트 라벨 PDF 생성

실행 방법:
메뉴 > 자동화 > 라벨 PDF 생성

처리 내용:
1) 주문_가공데이터에서 업체별, 제품별로 데이터 추출
2) 각 업체마다 1개의 PDF 파일 생성 (여러 페이지)
3) 각 페이지는 1개 제품의 라벨
4) 라벨 내용: 제품명(큰 글씨), 수량(큰 글씨), 업체코드

라벨 형식:
- A4 용지 1장에 1개 제품
- 큰 글씨로 출력 (현장에서 보기 쉽게)
- 가운데 정렬
- 테두리 표시

PDF 저장 위치:
Google Drive > 자동화_출력 > 라벨 폴더

파일명 형식:
업체코드_라벨_날짜.pdf
예시: 중부_라벨_20251217.pdf (13페이지)

예상 소요 시간: 약 3분 (50개 업체 기준)


3-4. 재고표 PDF 생성

실행 방법:
메뉴 > 자동화 > 재고표 PDF 생성

처리 내용:
1) 재고_원본 데이터를 유통기한 순으로 정렬
2) 재고_표시 시트에 정렬된 데이터 저장
3) PDF로 출력

PDF 저장 위치:
Google Drive > 자동화_출력 > 재고표 폴더

파일명 형식:
재고표_날짜.pdf
예시: 재고표_20251217.pdf

예상 소요 시간: 약 10초


========================================
4. 사용 방법
========================================

4-1. 최초 설정 (1회만)

1) Google Sheets 파일 열기
2) 업체코드_매핑 시트에 업체명과 코드 입력
   - 약 50개 업체 정보 입력
3) Google Drive에 출력 폴더 자동 생성 확인


4-2. 매일 사용 방법

1) SAP에서 주문 데이터 다운로드
2) 원본_주문데이터 시트를 열고 기존 데이터 삭제
3) SAP 데이터를 복사하여 붙여넣기
4) 메뉴 > 자동화 > 데이터 처리하기 클릭
5) 메뉴 > 자동화 > 주문서 PDF 생성 클릭 (약 3분 대기)
6) 메뉴 > 자동화 > 라벨 PDF 생성 클릭 (약 3분 대기)
7) Google Drive > 자동화_출력 폴더에서 PDF 확인
8) 필요한 PDF 파일 인쇄


4-3. 재고표 생성 (필요시)

1) 재고 파일 데이터를 재고_원본 시트에 붙여넣기
2) 메뉴 > 자동화 > 재고표 PDF 생성 클릭
3) Google Drive에서 재고표 PDF 확인


========================================
5. 주의사항
========================================

- Google Apps Script는 1회 실행 시간이 6분으로 제한됩니다
- 따라서 주문서와 라벨을 각각 따로 생성해야 합니다
- 업체 수가 많으면 시간이 더 걸릴 수 있습니다
- 인터넷 연결이 필요합니다
- Google 계정 로그인 상태 유지 필요


========================================
6. 기존 구상.txt와의 차이점
========================================

구상.txt 내용을 기반으로 하되, 다음과 같이 조정:

1) PDF 생성 시간 문제 해결
   - 구상: 한 번에 모두 생성
   - 실제: 주문서/라벨/재고표 각각 분리 생성

2) 자동 인쇄 제외
   - 구상: 자동 인쇄까지 고려
   - 실제: PDF 생성까지만, 인쇄는 수동

3) 시트 구조 단순화
   - 구상대로 5개 주요 시트 사용
   - 복잡한 중간 시트 제거


========================================
7. 예상 효과
========================================

기존 작업 시간: 2-3시간
자동화 후 시간: 약 10분
- 데이터 붙여넣기: 2분
- 데이터 처리: 10초
- 주문서 생성: 3분
- 라벨 생성: 3분
- PDF 확인 및 인쇄: 2분

시간 절약: 약 90%
